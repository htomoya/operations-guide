<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:fb="http://ogp.me/ns/fb#"><head>

<title>第14章 ロギングと監視 - OpenStack 運用ガイド</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/><meta name="mavenGroupId" content="org.openstack.docs"/><meta name="mavenArtifactId" content="openstack-ops-manual"/><meta name="mavenVersionId" content="1.0.0"/><link rel="home" href="index.html" title="OpenStack 運用ガイド"/><link rel="up" href="index.html" title="OpenStack 運用ガイド"/><link rel="prev" href="network_troubleshooting.html" title="第13章 ネットワークのトラブルシューティング"/><link rel="next" href="backup_and_recovery.html" title="第15章 バックアップとリカバリー"/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "treeview-10646";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Your browser is not supported. Use of Mozilla Firefox is recommended.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
        </script><style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(../common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
            
        </style><link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/><link rel="stylesheet" type="text/css" href="../common/css/positioning.css"/><link rel="stylesheet" type="text/css" href="../common/css/custom.css"/><!--[if IE]>
	<link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
	<![endif]--><link rel="stylesheet" type="text/css" href="../common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/><link rel="stylesheet" type="text/css" href="../common/jquery/treeview/jquery.treeview.css"/><script type="text/javascript" src="../common/jquery/jquery-1.4.3.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery.cookie.js"><!----></script><script type="text/javascript" src="../common/jquery/treeview/jquery.treeview.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery.qtip-1.0.0-rc3/jquery.qtip-1.0.0-rc3.min.js"><!--jQuery plugin for glossary popups. --></script><script type="text/javascript" src="search/htmlFileList.js"><!----></script><script type="text/javascript" src="search/htmlFileInfoList.js"><!----></script><script type="text/javascript" src="search/nwSearchFnt.js"><!----></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"><!--//make this scalable to other languages as well.--></script><script type="text/javascript" src="search/index-1.js"><!----></script><script type="text/javascript" src="search/index-2.js"><!----></script><script type="text/javascript" src="search/index-3.js"><!----></script><script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-17511903-1']);
	    
	    _gaq.push(['_setDomainName', '.openstack.org']);	        
	        </script><script type="text/javascript" src="../common/ga.js"><!----></script></head><body><div id="header"><a onclick="_gaq.push(['_trackEvent', 'Header', 'logo', 'click', 1]);" target="_blank" href="http://www.openstack.org"><img src="../common/images/openstack-logo.png" alt="OpenStack Documentation" width="157" height="47"/></a><h1>第14章 ロギングと監視</h1><div id="navheader" align="right"><!----><table class="navLinks"><tr><td><a id="showHideButton" onclick="showHideToc(); _gaq.push(['_trackEvent', 'Header', 'show/hide', 'click', 1]);" class="pointLeft" title="Hide TOC tree">Sidebar
                            </a></td><td><a accesskey="p" class="navLinkPrevious" onclick="_gaq.push(['_trackEvent', 'Header', 'prevLink', 'click', 1]);" tabindex="5" href="network_troubleshooting.html">戻る</a> 
				  |
                                    <a accesskey="n" class="navLinkNext" onclick="_gaq.push(['_trackEvent', 'Header', 'nextLink', 'click', 1]);" tabindex="5" href="backup_and_recovery.html">次へ</a></td></tr></table></div></div><div id="toolbar" class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"><div id="toolbar-left"><p class="breadcrumbs"><a href="http://docs.openstack.org/">OpenStack Manuals</a><a href="index.html">OpenStack 運用ガイド</a></p><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" alt="Download a pdf of this document" class="pdficon" href="../openstack-ops-manual-local.pdf"><img src="../common/images/pdf.png"/></a></div></div><div id="content"><div class="statustext"> </div><div xml:lang="ja" class="chapter"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="logging_monitoring"> </a>第14章 ロギングと監視</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="logging_monitoring.html#where_are_logs">ログはどこにあるのか？</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#how_to_read_logs">ログの読み方</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#tracing_instance_request">インスタンスリクエストの追跡</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#add_custom_logging">カスタムログの追加</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#rabbitmq">RabbitMQ Web管理インターフェイス および rabbitmqctl</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#manage_logs_centrally">ログの集中管理</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#stacktach">StackTach</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#monitoring">監視</a></span></dt></dl></div><p>OpenStackクラウドは、様々なサービスから構成されるため、多くのログファイルが存在します。このセクションでは、それぞれのログの場所と取り扱い、そしてシステムのさらなる監視方法について説明します。</p><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="where_are_logs"> </a>ログはどこにあるのか？</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="logging_monitoring.html#cloud_controller_ops">クラウドコントローラー</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#compute_nodes_ops">コンピュートノード</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#block_storage_nodes">ブロックストレージ ノード</a></span></dt></dl></div><p>Ubuntu では、ほとんどのサービスが <code class="code">/var/log</code> ディレクトリ以下のディレクトリにログファイルを出力するという慣習に従っています。</p><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="cloud_controller_ops"> </a>クラウドコントローラー</h3></div></div></div><table rules="all" id="d6e2852"><thead><tr>
                        <th>サービス</th>
                        <th>ログの場所</th>
                    </tr></thead><tbody><tr>
                        <td><p>
                                <code class="code">nova-*</code>
                            </p></td>
                        <td><p>
                                <code class="code">/var/log/nova</code>
                            </p></td>
                    </tr><tr>
                        <td><p>
                                <code class="code">glance-*</code>
                            </p></td>
                        <td><p>
                                <code class="code">/var/log/glance</code>
                            </p></td>
                    </tr><tr>
                        <td><p>
                                <code class="code">cinder-*</code>
                            </p></td>
                        <td><p>
                                <code class="code">/var/log/cinder</code>
                            </p></td>
                    </tr><tr>
                        <td><p>
                                <code class="code">keystone</code>
                            </p></td>
                        <td><p>
                                <code class="code">/var/log/keystone</code>
                            </p></td>
                    </tr><tr>
                        <td><p>horizon</p></td>
                        <td><p>
                                <code class="code">/var/log/apache2/</code>
                            </p></td>
                    </tr><tr>
                        <td><p>その他 (Swift, dnsmasq)</p></td>
                        <td><p>
                                <code class="code">/var/log/syslog</code>
                            </p></td>
                    </tr></tbody></table></div><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="compute_nodes_ops"> </a>コンピュートノード</h3></div></div></div><p>libvirt: <code class="code">/var/log/libvirt/libvirtd.log</code></p><p>VMインスタンスのコンソール (ブートメッセージ):  <code class="code">/var/lib/nova/instances/instance-&lt;instance id&gt;/console.log</code></p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="block_storage_nodes"> </a>ブロックストレージ ノード</h3></div></div></div><p>cinder: <code class="code">/var/log/cinder/cinder-volume.log</code></p></div></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="how_to_read_logs"> </a>ログの読み方</h2></div></div></div><p>OpenStack サービスは標準のロギングレベルを利用しています。重要度順のレベルは次の通りです(重要度の低い順): DEBUG、INFO、AUDIT、WARNING、ERROR、CRTICAL、TRACE。特定のログレベルより"重要"な場合のみメッセージはログに出力されます。ログレベルDEBUGの場合、すべてのログが出力されます。TRACEの場合、ソフトウェアがスタックトレースを持つ場合にのみログに出力されます。INFOの場合、情報のみのメッセージも含めて出力されます。</p><p>DEBUG レベルのロギングを無効にするには、以下のように <code class="code">/etc/nova/nova.conf</code> を編集します。</p><pre class="programlisting">debug=false</pre><p>Keystoneは少し異なる動作をします。ロギングレベルを変更するためには、<code class="code">/etc/keystone/logging.conf</code>を編集し、 <code class="code">logger_root </code>と<code class="code"> handler_file</code> を修正する必要があります。</p><p>Horizon のロギング設定は <code class="code">/etc/openstack_dashboard/local_settings.py</code> で行います。Horizon は Django web アプリケーションですので、<a class="link" href="https://docs.djangoproject.com/en/dev/topics/logging/" title="Django Logging" target="_top">Django Logging</a> (https://docs.djangoproject.com/en/dev/topics/logging/) フレームワークの規約に従います。</p><p>エラーの原因を見つけるための典型的な最初のステップは、 CRTICAL、TRACE、ERRORなどのメッセージがログファイルの終わりで出力されていないかを確認することです。</p><p>トレース(Pythonのコールスタック)付きのCRITICALなログメッセージの例は次の通りです。</p><pre class="programlisting">2013-02-25 21:05:51 17409 CRITICAL cinder [-] Bad or unexpected response from the storage volume backend API: volume group 
 cinder-volumes doesn't exist
2013-02-25 21:05:51 17409 TRACE cinder Traceback (most recent call last):
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/bin/cinder-volume", line 48, in &lt;module&gt;
2013-02-25 21:05:51 17409 TRACE cinder service.wait()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/cinder/service.py", line 422, in wait
2013-02-25 21:05:51 17409 TRACE cinder _launcher.wait()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/cinder/service.py", line 127, in wait
2013-02-25 21:05:51 17409 TRACE cinder service.wait()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/eventlet/greenthread.py", line 166, in wait
2013-02-25 21:05:51 17409 TRACE cinder return self._exit_event.wait()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/eventlet/event.py", line 116, in wait
2013-02-25 21:05:51 17409 TRACE cinder return hubs.get_hub().switch()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/eventlet/hubs/hub.py", line 177, in switch
2013-02-25 21:05:51 17409 TRACE cinder return self.greenlet.switch()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/eventlet/greenthread.py", line 192, in main
2013-02-25 21:05:51 17409 TRACE cinder result = function(*args, **kwargs)
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/cinder/service.py", line 88, in run_server
2013-02-25 21:05:51 17409 TRACE cinder server.start()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/cinder/service.py", line 159, in start
2013-02-25 21:05:51 17409 TRACE cinder self.manager.init_host()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/cinder/volume/manager.py", line 95, 
 in init_host
2013-02-25 21:05:51 17409 TRACE cinder self.driver.check_for_setup_error()
2013-02-25 21:05:51 17409 TRACE cinder File "/usr/lib/python2.7/dist-packages/cinder/volume/driver.py", line 116, 
 in check_for_setup_error
2013-02-25 21:05:51 17409 TRACE cinder raise exception.VolumeBackendAPIException(data=exception_message)
2013-02-25 21:05:51 17409 TRACE cinder VolumeBackendAPIException: Bad or unexpected response from the storage volume 
 backend API: volume group cinder-volumes doesn't exist
2013-02-25 21:05:51 17409 TRACE cinder</pre><p>この例では、cinder-volumesは起動に失敗し、スタックトレースを出力していまボリュームのバックエンドがストレージボリュームをセットアップできないため、おそらく、設定ファイルで指定された LVM ボリュームが存在しないと考えられます。</p><p>エラーログの例:</p><pre class="programlisting">2013-02-25 20:26:33 6619 ERROR nova.openstack.common.rpc.common [-] AMQP server on localhost:5672 is unreachable:
 [Errno 111] ECONNREFUSED. Trying again in 23 seconds.</pre><p>このエラーでは、novaサービスがRabbitMQへの接続に失敗していました。接続が拒否されたというエラーが出力されています。</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="tracing_instance_request"> </a>インスタンスリクエストの追跡</h2></div></div></div><p>インスタンスが正しく動作していない場合、インスタンスに関連したログを調べる必要があります。これらのログは複数の<code class="code">nova-*</code>サービスが出力しており、クラウドコントローラーとComputeノードの両方に存在します。</p><p>一般的な方法はインスタンスのUUIDをキーにして、各サービスのログを追跡することです。</p><p>次のような例を考えてみましょう。</p><pre class="programlisting">ubuntu@initial:~$ nova list
+--------------------------------------+--------+--------+---------------------------+
| ID                                   | Name   | Status | Networks                  |
+--------------------------------------+--------+--------+---------------------------+
| faf7ded8-4a46-413b-b113-f19590746ffe | cirros | ACTIVE | novanetwork=192.168.100.3 |
+--------------------------------------+--------+--------+---------------------------+</pre><p>ここで、インスタンスのUUIDは <code class="code">faf7ded8-4a46-413b-b113-f19590746ffe</code>です。クラウドコントローラー上の <code class="code">/var/log/nova-*.log</code>ファイルをこの文字列で検索すると、<code class="code">nova-api.log</code>と <code class="code">nova-scheduler.log</code>で見つかります。同様にComputeノードで検索した場合、<code class="code">nova-network.log</code> と <code class="code">nova-compute.log</code>で見つかります。もし、ERRORやCRITICALのメッセージが存在しない場合、最後のログエントリが、何が悪いかのヒントを示しているかもしれません。</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="add_custom_logging"> </a>カスタムログの追加</h2></div></div></div><p>もし、ログに十分な情報がない場合、あなた自身でカスタマイズしたログを <code class="code">nova-*</code>サービスに追加することができます。</p><p>ソースファイルは <code class="code">/usr/lib/python2.7/dist-packages/nova</code>に存在します。</p><p>ログステートメントを追加するには、次の行をファイルの先頭に置きます。ほとんどのファイルでは、これらは既に存在します。</p><pre class="programlisting">from nova.openstack.common import log as logging
LOG = logging.getLogger(__name__)</pre><p>DEBUGログステートメントを追加するには次のようにします。</p><pre class="programlisting">LOG.debug("This is a custom debugging statement")</pre><p>以下に例を示しますが、全てのログメッセージはアンダースコアで始まり、括弧で括られていることに気づいたでしょうか?</p><pre class="programlisting">LOG.debug(_("Logging statement appears here"))</pre><p>これは、ログメッセージを異なる言語に翻訳するために<a class="link" href="http://docs.python.org/2/library/gettext.html" target="_top">gettext</a> (http://docs.python.org/2/library/gettext.html) 国際化ライブラリ を利用しているためです。カスタムログには必要ありませんが、もし、OpenStackプロジェクトにログステートメントを含むコードを提供する場合は、アンダースコアと括弧でログメッセージを囲わなければなりません。</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="rabbitmq"> </a>RabbitMQ Web管理インターフェイス および rabbitmqctl</h2></div></div></div><p>接続失敗の問題はさておき、RabbitMQログファイルはOpenStackに関連した問題のデバッグにあまり有用ではありません。その代わりにRabbitMQ Web管理インターフェイスを推奨します。 クラウドコントローラーにおいて、以下のコマンドで有効になります。</p><pre class="programlisting"># /usr/lib/rabbitmq/bin/rabbitmq-plugins enable rabbitmq_management
# service rabbitmq-server restart</pre><p>RabbitMQ Web管理インターフェイスは、クラウドコントローラーから <code class="code"> http://localhost:55672 </code>でアクセスできます。</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../common/images/admon/note.png"/></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>Ubuntu 12.04はRabiitMQのバージョン2.7.1を55672番ポートを使うようにインストールします。RabbitMQバージョン3.0以降では15672が利用されます。Ubuntuマシン上でどのバージョンのRabbitMQが実行されているかは次のように確認できます。</p><pre class="programlisting">$ dpkg -s rabbitmq-server | grep "Version:"
Version: 2.7.1-0ubuntu4</pre></td></tr></table></div><p>An alternative to enabling the RabbitMQ Web Management
            Interface is to use the <span class="command"><strong>rabbitmqctl</strong></span> commands. For example,
                <span class="command"><strong>rabbitmqctl list_queues| grep
                cinder</strong></span> displays any messages
            left in the queue. If there are, it's a possible sign that
            cinder services didn't connect properly to rabbitmq and
            might have to be restarted.</p><p>RabbitMQで監視すべき項目としては、各キューでのアイテムの数と、サーバーでの処理時間の統計情報があります。</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="manage_logs_centrally"> </a>ログの集中管理</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="logging_monitoring.html#rsyslog_client_config">rsyslog クライアント設定</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#rsyslog_server_config">rsyslog サーバー設定</a></span></dt></dl></div><p>クラウドは多くのサーバーから構成されるため、各サーバー上にあるイベントログを繋ぎあわせて、ログをチェックしなければなりません。よい方法は全てのサーバーのログを一ヶ所にまとめ、同じ場所で確認できるようにすることです。</p><p>Ubuntuはrsyslog をデフォルトのロギングサービスとして利用します。rsyslog はリモートにログを送信する機能を持っているので、何かを追加でインストールする必要はなく、設定ファイルを変更するだけです。リモート転送を実施する際は、盗聴を防ぐためにログが自身の管理ネットワーク上を通る、もしくは暗号化VPNを利用することを考慮する必要があります。</p><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="rsyslog_client_config"> </a>rsyslog クライアント設定</h3></div></div></div><p>まず始めに、全てのOpenStackコンポーネントのログを標準ログに加えてsyslogに出力するように設定します。また、各コンポーネントが異なるsyslogファシリティになるように設定します。これによりログサーバー上で、個々のコンポーネントのログを分離しやすくなります。</p><p><code class="code">nova.conf</code>:</p><pre class="programlisting">use_syslog=True
syslog_log_facility=LOG_LOCAL0</pre><p><code class="code">glance-api.conf</code> および <code class="code">glance-registry.conf</code>:</p><pre class="programlisting">use_syslog=True
syslog_log_facility=LOG_LOCAL1</pre><p><code class="code">cinder.conf</code>:</p><pre class="programlisting">use_syslog=True
syslog_log_facility=LOG_LOCAL2</pre><p><code class="code">keystone.conf</code>:</p><pre class="programlisting">use_syslog=True
syslog_log_facility=LOG_LOCAL3</pre><p>Swift</p><p>デフォルトでSwiftはsyslogにログを出力します。</p><p>次に、<code class="code"> /etc/rsyslog.d/client.conf</code>に次の行を作成します。</p><pre class="programlisting">*.* @192.168.1.10</pre><p>これは、rsyslogに全てのログを指定したIPに送るように命令しており、このIPはクラウドコントローラーを指しています。</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="rsyslog_server_config"> </a>rsyslog サーバー設定</h3></div></div></div><p>集中ログサーバとして使用するサーバーを決めます。ログ専用のサーバーを利用するのが最も良いです。<code class="code"> /etc/rsyslog.d/server.conf </code>を次のように作成します。</p><pre class="programlisting"># Enable UDP 
$ModLoad imudp 
# Listen on 192.168.1.10 only 
$UDPServerAddress 192.168.1.10
# Port 514 
$UDPServerRun 514  
      
# Create logging templates for nova
$template NovaFile,"/var/log/rsyslog/%HOSTNAME%/nova.log" 
$template NovaAll,"/var/log/rsyslog/nova.log"
      

      
# Log everything else to syslog.log 
$template DynFile,"/var/log/rsyslog/%HOSTNAME%/syslog.log"
*.* ?DynFile
      

      
# Log various openstack components to their own individual file
local0.* ?NovaFile 
local0.* ?NovaAll 
&amp; ~</pre><p>この設定例はnovaサービスのみを扱っています。はじめに rsyslog を UDP 514番ポートで動作するサーバとして設定します。次に一連のログテンプレートを作成します。ログテンプレートは受け取ったログをどこに保管するかを指定します。上記の例を用いると、c01.example.comから送られるnovaのログは次の場所に保管されます。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
                        <code class="code">/var/log/rsyslog/c01.example.com/nova.log</code>
                    </p></li><li class="listitem"><p>
                        <code class="code">/var/log/rsyslog/nova.log</code>
                    </p></li></ul></div><p>c02.example.comから送られたログはこちらに保管されます。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
                        <code class="code">/var/log/rsyslog/c02.example.com/nova.log</code>
                    </p></li><li class="listitem"><p>
                        <code class="code">/var/log/rsyslog/nova.log</code>
                    </p></li></ul></div><p>全てのノードからのnovaのログを含む集約されたログと同様に、個々のコンピュートノードのログを持つことができます。</p></div></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="stacktach"> </a>StackTach</h2></div></div></div><p>StackTachはRackspaceによって作られたツールで、<code class="code">nova</code>から送られた通知を収集してレポートします。通知は本質的にはログと同じですが、より詳細な情報を持ちます。通知の概要のよい資料は、<a class="link" href="https://wiki.openstack.org/wiki/SystemUsageData" title="StackTach GitHub repo" target="_top">System Usage Data</a>(https://wiki.openstack.org/wiki/SystemUsageData).にあります。</p><p>novaで通知の送信を有効化するには次の行を <code class="code">nova.conf</code>に追加します。</p><pre class="programlisting">notification_topics=monitor 
notification_driver=nova.openstack.common.notifier.rabbit_notifier</pre><p><code class="code">nova</code>が通知を送信するように設定後、StackTachをインストールします。StackTachは新しく、頻繁に更新されるので、インストール手順はすぐに古くなります。<a class="link" href="https://github.com/rackerlabs/stacktach" target="_top">StackTach GitHub repo</a> (https://github.com/rackerlabs/stacktach) とデモビデオを参照して下さい。</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="monitoring"> </a>監視</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="logging_monitoring.html#process_monitoring">プロセス監視</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#resource_alerting">リソースのアラート</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#os_resources">OpenStack固有のリソース</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#intelligent_alerting">インテリジェントなアラート</a></span></dt><dt><span class="section"><a href="logging_monitoring.html#trending">トレンド</a></span></dt></dl></div><p>二つの監視のタイプがあります。問題の監視と、利用状況の監視です。前者は全てのサービスが動作していることを保証するものであり、後者は時間に沿ったリソース利用の監視をすることで、潜在的なボトルネックの発見とアップグレードのための情報を得るものです。</p><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="process_monitoring"> </a>プロセス監視</h3></div></div></div><p>基本的なアラート監視は、単純に必要なプロセスが実行されているかどうかをチェックすることです。例えば、 <code class="code">nova-api</code>サービスがクラウドコントローラーで動作していることを確認します。</p><pre class="programlisting">[ root@cloud ~ ] # ps aux | grep nova-api
nova 12786 0.0 0.0 37952 1312 ? Ss Feb11 0:00 su -s /bin/sh -c exec nova-api --config-file=/etc/nova/nova.conf nova
nova 12787 0.0 0.1 135764 57400 ? S Feb11 0:01 /usr/bin/python /usr/bin/nova-api --config-file=/etc/nova/nova.conf
nova 12792 0.0 0.0 96052 22856 ? S Feb11 0:01 /usr/bin/python /usr/bin/nova-api --config-file=/etc/nova/nova.conf
nova 12793 0.0 0.3 290688 115516 ? S Feb11 1:23 /usr/bin/python /usr/bin/nova-api --config-file=/etc/nova/nova.conf
nova 12794 0.0 0.2 248636 77068 ? S Feb11 0:04 /usr/bin/python /usr/bin/nova-api --config-file=/etc/nova/nova.conf
root 24121 0.0 0.0 11688 912 pts/5 S+ 13:07 0:00 grep nova-api</pre><p>NagiosとNRPEを使って、クリティカルなプロセスの自動化されたアラートを作成することが可能です。<code class="code">nova-compute</code> プロセスがコンピュートノードで動作していることを保証するために、Nagiosサーバー上で次のようなアラートを作成します。</p><pre class="programlisting">define service { 
    host_name c01.example.com 
    check_command check_nrpe_1arg!check_nova-compute 
    use generic-service 
    notification_period 24x7 
    contact_groups sysadmins 
    service_description nova-compute 
}</pre><p>そして、対象のコンピュートノードにおいて、次のようなNRPE設定を作成します。</p><pre class="programlisting">command[check_nova-compute]=/usr/lib/nagios/plugins/check_procs -c 1: -a nova-compute</pre><p>Nagiosは常に一つ以上の <code class="code">nova-compute</code>サービスが動作しているかをチェックします。</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="resource_alerting"> </a>リソースのアラート</h3></div></div></div><p>リソースのアラートは、一つ以上のリソースが極めて少なくなった場合に通知するものです。監視の閾値はインストールされたOpenStackの環境に合わせて設定すべきですが、リソース監視の利用方法は、OpenStackに固有の話ではありません。一般的なアラートのタイプが利用できます。</p><p>監視項目に含む幾つかのリソースをあげます。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>ディスク使用量</p></li><li class="listitem"><p>サーバー負荷</p></li><li class="listitem"><p>メモリ使用量</p></li><li class="listitem"><p>ネットワーク IO</p></li><li class="listitem"><p>利用可能な vCPU 数</p></li></ul></div><p>例として、コンピュートノード上のディスク容量をNagiosを使って監視する場合、次のようなNagios設定を追加します。</p><pre class="programlisting">define service { 
    host_name c01.example.com 
    check_command check_nrpe!check_all_disks!20% 10% 
    use generic-service 
    contact_groups sysadmins 
    service_description Disk 
}</pre><p>コンピュートノード上では、次のようなNRPE設定を追加します。</p><pre class="programlisting">command[check_all_disks]=/usr/lib/nagios/plugins/check_disk -w $ARG1$ -c $ARG2$ -e</pre><p>Naigosは、80%のディスク使用率でWARNING、90%でCRITICALを警告します。%i_dummy%f_dummy</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="os_resources"> </a>OpenStack固有のリソース</h3></div></div></div><p>メモリ、ディスク、CPUのような一般的なリソースは、全てのサーバー(OpenStackに関連しないサーバーにも)に存在するため、サーバーの状態監視において重要です。OpenStackの場合、インスタンスを起動するために必要なリソースが確実に存在するかの確認という点でも重要です。OpenStackのリソースを見るためには幾つかの方法が存在します。</p><p>最初は <code class="code">nova</code> コマンドを利用した例です。</p><pre class="programlisting"># nova usage-list</pre><p>このコマンドはテナント上で実行されるインスタンスのリストと、インスタンス全体の簡単な利用統計を表示します。クラウドの簡単な概要を得るのに便利なコマンドですが、より詳細な情報については表示しません。</p><p>次に <code class="code">nova</code> データベースは 利用情報に関して3つのテーブルを持っています。</p><p><code class="code">nova.quotas</code>と <code class="code">nova.quota_usages</code> テーブルはクォータの情報が保管されています。もし、テナントのクォータがデフォルト設定と異なる場合、<code class="code">nova.quotas</code>に保管されます。以下に例を示します。</p><pre class="programlisting">mysql&gt; select project_id, resource, hard_limit from quotas; 
+----------------------------------+-----------------------------+------------+
| project_id                       | resource                    | hard_limit |
+----------------------------------+-----------------------------+------------+
| 628df59f091142399e0689a2696f5baa | metadata_items              | 128        |
| 628df59f091142399e0689a2696f5baa | injected_file_content_bytes | 10240      |
| 628df59f091142399e0689a2696f5baa | injected_files              | 5          |
| 628df59f091142399e0689a2696f5baa | gigabytes                   | 1000       |
| 628df59f091142399e0689a2696f5baa | ram                         | 51200      |
| 628df59f091142399e0689a2696f5baa | floating_ips                | 10         |
| 628df59f091142399e0689a2696f5baa | instances                   | 10         |
| 628df59f091142399e0689a2696f5baa | volumes                     | 10         |
| 628df59f091142399e0689a2696f5baa | cores                       | 20         |
+----------------------------------+-----------------------------+------------+ </pre><p><code class="code">nova.quota_usages</code>テーブルはどのくらいリソースをテナントが利用しているかを記録しています。</p><pre class="programlisting">mysql&gt; select project_id, resource, in_use from quota_usages where project_id like '628%';
+----------------------------------+--------------+--------+ 
| project_id                       | resource     | in_use | 
+----------------------------------+--------------+--------+ 
| 628df59f091142399e0689a2696f5baa | instances    | 1      |
| 628df59f091142399e0689a2696f5baa | ram          | 512    | 
| 628df59f091142399e0689a2696f5baa | cores        | 1      | 
| 628df59f091142399e0689a2696f5baa | floating_ips | 1      | 
| 628df59f091142399e0689a2696f5baa | volumes      | 2      | 
| 628df59f091142399e0689a2696f5baa | gigabytes    | 12     | 
| 628df59f091142399e0689a2696f5baa | images       | 1      | 
+----------------------------------+--------------+--------+</pre><p>リソース利用をテナントのクォータと結合することで、利用率を求めることが出来ます。例えば、テナントが、10個のうち1つのFloating IPを利用しているとすると、10%のFloating IP クォータを利用することになります。これを行なうことで、レポートを作ることができます。</p><pre class="programlisting">+-----------------------------------+------------+-------------+---------------+ 
| some_tenant                                                                  | 
+-----------------------------------+------------+-------------+---------------+ 
| Resource                          | Used       | Limit       |               | 
+-----------------------------------+------------+-------------+---------------+ 
| cores                             | 1          | 20          |           5 % | 
| floating_ips                      | 1          | 10          |          10 % | 
| gigabytes                         | 12         | 1000        |           1 % | 
| images                            | 1          | 4           |          25 % | 
| injected_file_content_bytes       | 0          | 10240       |           0 % | 
| injected_file_path_bytes          | 0          | 255         |           0 % | 
| injected_files                    | 0          | 5           |           0 % | 
| instances                         | 1          | 10          |          10 % | 
| key_pairs                         | 0          | 100         |           0 % | 
| metadata_items                    | 0          | 128         |           0 % | 
| ram                               | 512        | 51200       |           1 % | 
| reservation_expire                | 0          | 86400       |           0 % | 
| security_group_rules              | 0          | 20          |           0 % | 
| security_groups                   | 0          | 10          |           0 % | 
| volumes                           | 2          | 10          |          20 % | 
+-----------------------------------+------------+-------------+---------------+</pre><p>上記の出力はこのGithub (https://github.com/cybera/novac/blob/dev/libexec/novac-quota-report) にあるカスタムスクリプトを用いて作成しました。</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../common/images/admon/note.png"/></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>このスクリプトは特定のOpenStackインストール環境向けなので、自身の環境に適用する際には変更しなくてはいけませんが、ロジックは簡単に変更できるでしょう。</p></td></tr></table></div></div><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="intelligent_alerting"> </a>インテリジェントなアラート</h3></div></div></div><p>インテリジェントなアラートは運用における継続的インテグレーションの要素の一つです。例えば、以下のような方法で簡単にGlanceが起動しているかを簡単に確認できます。<code class="code">glance-api</code>と<code class="code">glance-registry</code>プロセスが起動していることの確認する、もしくは<code class="code">glace-api</code>が9292ポートに応答するといった方法です。</p><p>しかし、イメージサービスにイメージが正しくアップロードされたことをどのように知ればいいのでしょうか? もしかしたら、イメージサービスが保管しているイメージのディスクが満杯、もしくはS3のバックエンドがダウンしているかもしれません。簡易的なイメージアップロードを行なうことでこれをチェックすることができます。</p><pre class="programlisting">#!/bin/bash 
# 
# assumes that resonable credentials have been stored at 
# /root/auth 
 
      
. /root/openrc 
wget https://launchpad.net/cirros/trunk/0.3.0/+download/cirros-0.3.0-x86_64-disk.img  
glance image-create --name='cirros image' --is-public=true --container-format=bare --disk-format=qcow2 &lt; cirros-0.3.0-x8
6_64-disk.img</pre><p>このスクリプトを(Nagiosのような)監視システムに組込むことで、イメージカタログのアップロードが動作していることを自動的に確認することができます。</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../common/images/admon/note.png"/></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>毎回テスト後にイメージを削除する必要があります。イメージサービスからイメージが削除できるかのテストにしてしまえば、さらによいです。</p></td></tr></table></div><p>インテリジェントなアラートは、この章で述べられているの他のアラートよりも計画、実装にかなり時間を要します。インテリジェントなアラートを実装する流れは次のようになります。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>構築したクラウドにおいて一般的なアクションをレビューする</p></li><li class="listitem"><p>それらのアクションに対して自動テストを作成する</p></li><li class="listitem"><p>それらのテストをアラートシステムに組み込む</p></li></ul></div><p>インテリジェントアラートのその他の例としては以下があります。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>インスタンスの起動と削除が可能か?</p></li><li class="listitem"><p>ユーザの作成は可能か?</p></li><li class="listitem"><p>オブジェクトの保存と削除は可能か?</p></li><li class="listitem"><p>ボリュームの作成と削除は可能か?</p></li></ul></div></div><div class="section"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="trending"> </a>トレンド</h3></div></div></div><p>トレンドはどのようにクラウドが実行されているかの素晴しい見通しを与えてくれます。例えば、負荷の高い日がたまたま発生したのか、新しいコンピュートノードを追加すべきか、などです。</p><p>トレンドはアラートとは全く異なったアプローチです。アラートは二値の結果(チェックが成功するか失敗するか)に注目しているのに対して、トレンドはある時点での状態を定期的に記録します。十分な量が記録されれば、時系列でどのように値が変化するかを確認できます。</p><p>これまでに示した全てのアラートタイプは、トレンドレポートに利用可能です。その他のトレンドの例は以下の通りです。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>各コンピュートノード上のインスタンス数</p></li><li class="listitem"><p>使用中のインスタンス種別 （flavor）</p></li><li class="listitem"><p>使用中のボリューム数</p></li><li class="listitem"><p>1時間あたりの Object Storage リクエスト数</p></li><li class="listitem"><p>1時間あたりの nova-api リクエスト数</p></li><li class="listitem"><p>ストレージサービスの I/O の統計</p></li></ul></div><p>例として、<code class="code">nova-api</code>の使用を記録することでクラウドコントローラーをスケールする必要があるかを追跡できます。<code class="code">nova-api</code>のリクエスト数に注目することにより、<code class="code">nova-api</code>プロセスを追加するか、もしくは、<code class="code">nova-api</code>を実行するための新しいサーバーを導入することまで行なうかを決定することができます。リクエストの概数を取得するには<code class="code">/var/log/nova/nova-api.log</code>のINFOメッセージを検索します。</p><p># grep INFO /var/log/nova/nova-api.log | wc</p><p>成功したリクエストを検索することで、更なる情報を取得できます。</p><p># grep " 200 " /var/log/nova/nova-api.log | wc</p><p>このコマンドを定期的に実行し結果を記録することで、トレンドレポートを作ることができます。これにより<code class="code">/var/log/nova/nova-api.log</code>の使用量が増えているのか、減っているのか、安定しているのか、を知ることができます。</p><p>collectdのようなツールはこのような情報を保管することに利用できます。collectdはこの本のスコープから外れますが、collectdでCOUNTERデータ形として結果を保存するのがよい出発点になります。より詳しい情報はcollectdのドキュメント (https://collectd.org/wiki/index.php/Data_source)を参照してください。</p></div></div></div><script type="text/javascript" src="../common/main.js"><!----></script><hr/><div id="disqus_thread"><script type="text/javascript">
	      if(window.location.protocol.substring(0,4) == 'http'){
	        var disqus_shortname = 'openstack-ops';
	      
	        var disqus_identifier = 'openstack-operations-guidelogging_monitoring';
	      
	      }
	    </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><script type="text/javascript" src="../common/comments.js"><!----></script></div><hr/><div class="legal"><a href="index.html">Legal notices</a></div></div><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div id="tabs"><ul><li><a href="#treeDiv" tabindex="1"><span class="contentsTab">目次</span></a></li><li><a href="#searchDiv" tabindex="1"><span class="searchTab">Search</span></a></li></ul><div id="treeDiv"><img src="../common/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"/><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li tabindex="2"><span class="file"><a href="ch_doc_history.html">ドキュメント変更履歴</a></span></li><li tabindex="2"><span class="file"><a href="section_yk2_jpr_lj.html">はじめに</a></span><ul><li tabindex="2"><span class="file"><a href="section_yk2_jpr_lj.html#chapter_gk2_jpr_lj">この本をなぜ書いたか？どうやって書いたか？</a></span></li><li tabindex="2"><span class="file"><a href="section_yk2_jpr_lj.html#section_gl2_jpr_lj">この本の作成に参加するには</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="section_arch_provision.html">1. プロビジョニングとデプロイメント</a></span><ul><li tabindex="2"><span class="file"><a href="section_arch_provision.html#automated_deploy">自動デプロイメント</a></span><ul><li tabindex="2"><span class="file"><a href="section_arch_provision.html#disk_partition_raid">ディスクのパーティショニングと RAID</a></span></li><li tabindex="2"><span class="file"><a href="section_arch_provision.html#network_config">ネットワーク設定</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="section_arch_provision.html#auto_config">自動環境設定</a></span></li><li tabindex="2"><span class="file"><a href="section_arch_provision.html#remote_mgmt">リモート管理</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html">2. クラウドコントローラーの設計</a></span><ul><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#hardware_consid">ハードウェアの考慮事項</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#separate_services">サービスの分離</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#database">データベース</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#message_queue">メッセージキュー</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#api">Application Programming Interface (API)</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#extensions">API 拡張</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#scheduler">スケジューラー</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#images">イメージ</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#dashboard">Dashboard</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#authentication">認証および認可</a></span></li><li tabindex="2"><span class="file"><a href="cloud_controller_design.html#network_consid">ネットワークの考慮事項</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="scaling.html">3. スケーリング</a></span><ul><li tabindex="2"><span class="file"><a href="scaling.html#starting">スタートポイント</a></span></li><li tabindex="2"><span class="file"><a href="scaling.html#add_controller_nodes">Controller ノードの追加</a></span></li><li tabindex="2"><span class="file"><a href="scaling.html#segregate_cloud">クラウドの分離</a></span><ul><li tabindex="2"><span class="file"><a href="scaling.html#cells_regions">セルとリージョン</a></span></li><li tabindex="2"><span class="file"><a href="scaling.html#availability_zones">アベイラビリティゾーンとホストアグリゲート</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="scaling.html#scalable_hardware">スケーラブルハードウェア</a></span><ul><li tabindex="2"><span class="file"><a href="scaling.html#hardware_procure">ハードウェア調達</a></span></li><li tabindex="2"><span class="file"><a href="scaling.html#capacity_planning">キャパシティプランニング</a></span></li><li tabindex="2"><span class="file"><a href="scaling.html#burin_testing">エージング試験</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="compute_nodes.html">4. コンピュートノード</a></span><ul><li tabindex="2"><span class="file"><a href="compute_nodes.html#cpu_choice">CPU の選択</a></span></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#hypervisor_choice">ハイパーバイザーの選択</a></span></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#instance_storage">インスタンスストレージのソリューション</a></span><ul><li tabindex="2"><span class="file"><a href="compute_nodes.html#off_compute_node_storage">コンピュートノード外のストレージ – 共有ファイルシステム</a></span></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#on_compute_node_storage">コンピュートノード上のストレージ – 共有ファイルシステム</a></span></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#on_compute_node_storage_nonshared">コンピュートノード上のストレージ – 非共有ファイルシステム</a></span></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#live_migration">ライブマイグレーションに関する問題</a></span></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#file_systems">ファイルシステムの選択</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#overcommit">オーバーコミット</a></span></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#logging">ロギング</a></span></li><li tabindex="2"><span class="file"><a href="compute_nodes.html#networking">ネットワーク</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="storage_decision.html">5. ストレージ選定</a></span><ul><li tabindex="2"><span class="file"><a href="storage_decision.html#storage_concepts">ストレージのコンセプト</a></span><ul><li tabindex="2"><span class="file"><a href="storage_decision.html#object_storage">オブジェクト・ストレージ</a></span></li><li tabindex="2"><span class="file"><a href="storage_decision.html#block_storage">ブロックストレージ</a></span></li><li tabindex="2"><span class="file"><a href="storage_decision.html#file_level_storage">ファイルレベル・ストレージ</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="storage_decision.html#storage_backends">ストレージ・バックエンドの選択</a></span><ul><li tabindex="2"><span class="file"><a href="storage_decision.html#commodity_storage_backends">コモディティ・ハードウェア上の ストレージ技術</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="storage_decision.html#openstack_object_storage">OpenStack Object Storage の注意事項</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="network_design.html">6. ネットワーク設計</a></span><ul><li tabindex="2"><span class="file"><a href="network_design.html#mgmt_network">管理ネットワーク</a></span></li><li tabindex="2"><span class="file"><a href="network_design.html#public_addressing">パブリックアドレスの選択肢</a></span></li><li tabindex="2"><span class="file"><a href="network_design.html#ip_address_planning">IP アドレス計画</a></span></li><li tabindex="2"><span class="file"><a href="network_design.html#network_topology">ネットワークトポロジー</a></span><ul><li tabindex="2"><span class="file"><a href="network_design.html#vlans">VLAN</a></span></li><li tabindex="2"><span class="file"><a href="network_design.html#multi_nic">マルチNIC</a></span></li><li tabindex="2"><span class="file"><a href="network_design.html#multi_host_single_host_networks">マルチホストネットワークとシングルホストネットワーク</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="network_design.html#services_for_networking">ネットワーク関係のサービス</a></span><ul><li tabindex="2"><span class="file"><a href="network_design.html#ntp">NTP</a></span><ul><li tabindex="2"><span class="file"><a href="network_design.html#dns">DNS</a></span></li></ul></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="example_architecture.html">7. 参考アーキテクチャ</a></span><ul><li tabindex="2"><span class="file"><a href="example_architecture.html#overview">概要</a></span></li><li tabindex="2"><span class="file"><a href="example_architecture.html#rationale">設定指針</a></span><ul><li tabindex="2"><span class="file"><a href="example_architecture.html#quantum">なぜ OpenStack Network Service (quantum) を使わないか？</a></span></li><li tabindex="2"><span class="file"><a href="example_architecture.html#multi-host-networking">なぜマルチホストネットワークを使うか？</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="example_architecture.html#detailed_desc">詳細な説明</a></span></li><li tabindex="2"><span class="file"><a href="example_architecture.html#optional_extensions">さらなる拡張</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="whats_next.html">8. 次はどうする？</a></span></li><li tabindex="2"><span class="file"><a href="lay_of_the_land.html">9. 環境を把握する</a></span><ul><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#cli_tools">クライアントコマンドラインツール</a></span><ul><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#install_tools">ツールの導入</a></span></li><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#admin_cli">管理系コマンドラインツール</a></span></li><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#get_creds">認証情報の取得方法</a></span></li><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#cli_tricks">コマンドラインのこつと罠</a></span><ul><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#curl">cURL</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#servers_services">サーバーとサービス</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#network">ネットワーク</a></span></li><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#users_projects">ユーザおよびプロジェクト</a></span></li><li tabindex="2"><span class="file"><a href="lay_of_the_land.html#running_instances">稼働中インスタンス</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="projects_users.html">10. プロジェクトとユーザーの管理</a></span><ul><li tabindex="2"><span class="file"><a href="projects_users.html#projects_or_tenants">プロジェクトかテナントか?</a></span></li><li tabindex="2"><span class="file"><a href="projects_users.html#managing_projects">プロジェクトの管理</a></span><ul><li tabindex="2"><span class="file"><a href="projects_users.html#add_projects">プロジェクトの追加</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="projects_users.html#quotas">クォータ</a></span></li><li tabindex="2"><span class="file"><a href="projects_users.html#user_mgmt">ユーザー管理</a></span></li><li tabindex="2"><span class="file"><a href="projects_users.html#create_new_users">新規ユーザーの作成</a></span></li><li tabindex="2"><span class="file"><a href="projects_users.html#associate_users_with_projects">プロジェクトへのユーザーの割り当て</a></span><ul><li tabindex="2"><span class="file"><a href="projects_users.html#customize_auth">権限のカスタマイズ</a></span></li><li tabindex="2"><span class="file"><a href="projects_users.html#problem_users">他のユーザーに悪影響を与えるユーザー</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="user_facing_operations.html">11. ユーザーによる運用</a></span><ul><li tabindex="2"><span class="file"><a href="user_facing_images.html">イメージ</a></span><ul><li tabindex="2"><span class="file"><a href="user_facing_images.html#add_images">イメージの追加</a></span></li><li tabindex="2"><span class="file"><a href="user_facing_images.html#delete_images">イメージの削除</a></span></li><li tabindex="2"><span class="file"><a href="user_facing_images.html#other_cli">他の CLI オプション</a></span></li><li tabindex="2"><span class="file"><a href="user_facing_images.html#image_service_and_database">イメージサービスおよびデータベース</a></span></li><li tabindex="2"><span class="file"><a href="user_facing_images.html#sample_image_database">イメージサービスのデータベースクエリーの例</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="flavors.html">フレーバー</a></span><ul><li tabindex="2"><span class="file"><a href="flavors.html#d6e1977">どのように既存のフレーバーを変更しますか?</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="security_groups.html">セキュリティグループ</a></span></li><li tabindex="2"><span class="file"><a href="user_facing_block_storage.html">ブロックストレージ</a></span><ul><li tabindex="2"><span class="file"><a href="user_facing_block_storage.html#block_storage_creation_failures">ブロックストレージの作成エラー</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="instances.html">インスタンス</a></span><ul><li tabindex="2"><span class="file"><a href="instances.html#start_instances">インスタンスの起動</a></span></li><li tabindex="2"><span class="file"><a href="instances.html#instance_boot_failures">インスタンスの起動失敗</a></span></li><li tabindex="2"><span class="file"><a href="instances.html#instance_specific_data">インスタンス固有のデータ</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="associate_security_groups.html">セキュリティグループの割り当て</a></span></li><li tabindex="2"><span class="file"><a href="floating_ips.html">Floating IP</a></span></li><li tabindex="2"><span class="file"><a href="attach_block_storage.html">ブロックストレージの接続</a></span></li><li tabindex="2"><span class="file"><a href="snapsnots.html">スナップショットの取得</a></span><ul><li tabindex="2"><span class="file"><a href="snapsnots.html#consistent_snapshots">スナップショットの一貫性の保証</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="database_instances.html">データベースにあるインスタンス</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="maintenance.html">12. メンテナンス、故障およびデバッグ</a></span><ul><li tabindex="2"><span class="file"><a href="maintenance.html#cloud_controller_storage">クラウドコントローラーとストレージプロキシの故障とメンテナンス</a></span><ul><li tabindex="2"><span class="file"><a href="maintenance.html#planned_maintenance">計画メンテナンス</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#reboot_cloud_controller">クラウドコントローラーとストレージプロキシの再起動</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#after_a_cc_reboot">クラウドコントローラーまたはストレージプロキシの再起動後</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#cc_failure">全体的なクラウドコントローラーの故障</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="maintenance.html#compute_node_failures">コンピュートノードの故障とメンテナンス</a></span><ul><li tabindex="2"><span class="file"><a href="maintenance.html#planned_maintenance_compute_node">計画メンテナンス</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#after_compute_node_reboot">Compute ノードの再起動後</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#maintenance_instances">インスタンス</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#inspect_and_recover_failed_instances">故障したインスタンスからの検査とデータ復旧</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#volumes">ボリューム</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#totle_compute_node_failure">全体的なコンピュートノードの故障</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#var_lib_nova_instances">/var/lib/nova/instances</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="maintenance.html#storage_node_failures">ストレージノードの故障とメンテナンス</a></span><ul><li tabindex="2"><span class="file"><a href="maintenance.html#reboot_storage_node">ストレージノードの再起動</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#shut_down_storage_node">ストレージノードのシャットダウン</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#replace_swift_disk">Swift ディスクの交換</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="maintenance.html#complete_failure">完全な故障の対処</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#config_mgmt">構成管理</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#hardware">ハードウェアの取り扱い</a></span><ul><li tabindex="2"><span class="file"><a href="maintenance.html#add_new_node">コンピュートノードの追加</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#add_new_object_node">オブジェクトストレージノードの追加</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#replace_components">コンポーネントの交換</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="maintenance.html#databases">データベース</a></span><ul><li tabindex="2"><span class="file"><a href="maintenance.html#database_connect">データベース接続性</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#perf_and_opt">パフォーマンスおよび最適化</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="maintenance.html#hdmy">HDWMY</a></span><ul><li tabindex="2"><span class="file"><a href="maintenance.html#hourly">毎時</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#daily">日次</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#weekly">週次</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#monthly">月次</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#quarterly">四半期ごと</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#semiannual">半年ごと</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="maintenance.html#broken_component">故障しているコンポーネントの特定</a></span><ul><li tabindex="2"><span class="file"><a href="maintenance.html#tailing_logs">最新ログの確認</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#daemons_cli">CLI におけるデーモンの実行法</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#complexity">複雑さの例</a></span></li><li tabindex="2"><span class="file"><a href="maintenance.html#upgrades">アップグレード</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="network_troubleshooting.html">13. ネットワークのトラブルシューティング</a></span><ul><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#check_interface_states">"ip a" を使ってインタフェース状態をチェックする</a></span></li><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#network_traffic_in_cloud">クラウド上のネットワークトラフィック</a></span></li><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#failure_in_path">経路上の障害を見つける</a></span></li><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#tcpdump">tcpdump</a></span></li><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#iptables">iptables</a></span></li><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#network_config_database">データベースにあるネットワーク設定</a></span><ul><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#deassociate_floating_ip">手動でフローティングIPの関連付けを解除する</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#debug_dhcp_issues">DHCP の問題をデバッグする</a></span></li><li tabindex="2"><span class="file"><a href="network_troubleshooting.html#debugging_dns_issues">DNS の問題をデバッグする</a></span></li></ul></li><li tabindex="2" id="webhelp-currentid"><span class="file"><a href="logging_monitoring.html">14. ロギングと監視</a></span><ul><li tabindex="2"><span class="file"><a href="logging_monitoring.html#where_are_logs">ログはどこにあるのか？</a></span><ul><li tabindex="2"><span class="file"><a href="logging_monitoring.html#cloud_controller_ops">クラウドコントローラー</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#compute_nodes_ops">コンピュートノード</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#block_storage_nodes">ブロックストレージ ノード</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#how_to_read_logs">ログの読み方</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#tracing_instance_request">インスタンスリクエストの追跡</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#add_custom_logging">カスタムログの追加</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#rabbitmq">RabbitMQ Web管理インターフェイス および rabbitmqctl</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#manage_logs_centrally">ログの集中管理</a></span><ul><li tabindex="2"><span class="file"><a href="logging_monitoring.html#rsyslog_client_config">rsyslog クライアント設定</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#rsyslog_server_config">rsyslog サーバー設定</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#stacktach">StackTach</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#monitoring">監視</a></span><ul><li tabindex="2"><span class="file"><a href="logging_monitoring.html#process_monitoring">プロセス監視</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#resource_alerting">リソースのアラート</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#os_resources">OpenStack固有のリソース</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#intelligent_alerting">インテリジェントなアラート</a></span></li><li tabindex="2"><span class="file"><a href="logging_monitoring.html#trending">トレンド</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="backup_and_recovery.html">15. バックアップとリカバリー</a></span><ul><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#what_to_backup">バックアップ対象</a></span></li><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#database_backups">データベース バックアップ</a></span></li><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#file_system_backups">ファイルシステム バックアップ</a></span><ul><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#compute">Compute</a></span></li><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#image_catalog_delivery">イメージカタログと配布</a></span></li><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#identity">認証</a></span></li><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#ops_block_storage">ブロックストレージ</a></span></li><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#ops_object_storage">オブジェクト・ストレージ</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="backup_and_recovery.html#recovering_backups">バックアップのリカバリー</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="customize.html">16. カスタマイズ</a></span><ul><li tabindex="2"><span class="file"><a href="customize.html#devstack">DevStack</a></span></li><li tabindex="2"><span class="file"><a href="customize.html#middleware_example">ミドルウェア例</a></span></li><li tabindex="2"><span class="file"><a href="customize.html#nova_scheduler_example">Nova スケジューラーの例</a></span></li><li tabindex="2"><span class="file"><a href="customize.html#ops_dashboard">Dashboard</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html">17. OpenStack コミュニティ</a></span><ul><li tabindex="2"><span class="file"><a href="upstream_openstack.html#get_help">助けを得る</a></span></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html#report_bugs">バグ報告</a></span><ul><li tabindex="2"><span class="file"><a href="upstream_openstack.html#confirm_priority">バグの確認と優先付け</a></span></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html#bug_fixing">バグ修正</a></span></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html#after_change_is_accepted">変更が受理された後</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html#openstack_community">OpenStack コミュニティに参加する</a></span></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html#features">機能と開発ロードマップ</a></span></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html#contribute_to_docs">ドキュメント作成への貢献の仕方</a></span></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html#security_info">セキュリティ情報</a></span></li><li tabindex="2"><span class="file"><a href="upstream_openstack.html#additional_info">さらに情報を見つける</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="use-cases.html">A. 事例</a></span><ul><li tabindex="2"><span class="file"><a href="nectar.html">NeCTAR</a></span><ul><li tabindex="2"><span class="file"><a href="nectar_deploy.html">デプロイ</a></span></li><li tabindex="2"><span class="file"><a href="nectar_resources.html">リソース</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="mit_csail.html">MIT CSAIL</a></span><ul><li tabindex="2"><span class="file"><a href="mit_csail_deploy.html">デプロイ</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="dair.html">DAIR</a></span><ul><li tabindex="2"><span class="file"><a href="dair_deploy.html">デプロイ</a></span></li><li tabindex="2"><span class="file"><a href="dair_resources.html">リソース</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="cern.html">CERN</a></span><ul><li tabindex="2"><span class="file"><a href="cern_deploy.html">デプロイ</a></span></li><li tabindex="2"><span class="file"><a href="cern_resources.html">リソース</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="app_crypt.html">B. ハリウッド^H^H^H^H^Hクラウド・ナイトメア</a></span><ul><li tabindex="2"><span class="file"><a href="double_vlan.html">ダブル VLAN</a></span></li><li tabindex="2"><span class="file"><a href="issue.html">「あの問題」</a></span></li><li tabindex="2"><span class="file"><a href="disappear_images.html">イメージの消失</a></span></li><li tabindex="2"><span class="file"><a href="valentines.html">バレンタインデーの compute ノード大虐殺</a></span></li><li tabindex="2"><span class="file"><a href="rabbithole.html">ウサギの穴に落ちて</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="recommended-reading.html">C. リソース</a></span></li><li tabindex="2"><span class="file"><a href="go01.html">用語集</a></span></li></ul></div></div><div id="searchDiv"><div id="search"><form onsubmit="Verifie(ditaSearch_Form);return false" name="ditaSearch_Form" class="searchForm"><fieldset class="searchFieldSet"><legend>Search</legend><center><input id="textToSearch" name="textToSearch" type="text" class="searchText"/> &nbsp; <input onclick="Verifie(ditaSearch_Form)" type="button" class="searchButton" value="Go" id="doSearch"/></center></fieldset></form></div><div id="searchResults"><center/></div><p class="searchHighlight"><a href="#" onclick="toggleHighlight()">Search Highlighter (On/Off)</a></p></div></div></div></div><script type="text/javascript" src="../common/jquery/jquery.qtip-1.0.0-rc3/jquery.qtip-1.0.0-rc3.min.js"><!--jQuery plugin for glossary popups. -->
                   $('a[title]').qtip({ style: { name: 'cream', tip: true } })
                </script></body></html>